# AI Scientist åœ¨ SCI é¢†åŸŸçš„åº”ç”¨ - å®Œæ•´è®¾è®¡æ–‡æ¡£ v3.0

> **æœ€æ–°ç‰ˆæœ¬**: AnalysisAgent ä½¿ç”¨ LLM è¿›è¡Œæ™ºèƒ½å¸•ç´¯æ‰˜å‰æ²¿éªŒè¯å’Œè¶‹åŠ¿åˆ†æ

---

## ç³»ç»Ÿç®€ä»‹

åŸºäº Kosmos AI Scientist å’Œ CIAS-X å¾ªç¯ç®—æ³•ï¼Œå®ç°å…¨è‡ªåŠ¨ AI ç§‘å­¦å®¶ç³»ç»Ÿï¼Œç”¨äº SCI é¢†åŸŸå®éªŒæ¢ç´¢ã€‚

### æ ¸å¿ƒå‡çº§ v3.0 â­

- âœ… **LLM é©±åŠ¨çš„å¸•ç´¯æ‰˜éªŒè¯**: ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹éªŒè¯å¸•ç´¯æ‰˜å‰æ²¿åˆç†æ€§
- âœ… **æ™ºèƒ½è¶‹åŠ¿åˆ†æ**: LLM è‡ªåŠ¨å‘ç°éšè—æ¨¡å¼å’Œè§„å¾‹
- âœ… **å®éªŒå»ºè®®ç”Ÿæˆ**: LLM æä¾›ä¸‹ä¸€æ­¥å®éªŒæ–¹æ¡ˆ
- âœ… **OpenAI å…¼å®¹**: æ”¯æŒæ‰€æœ‰ OpenAI API æ ¼å¼çš„ LLM
- âœ… **å®Œæ•´å¯è¿½æº¯**: è®°å½•æ‰€æœ‰ LLM åˆ†æè¿‡ç¨‹å’Œæ¨ç†

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AI Scientist ä¸»å¾ªç¯                     â”‚
â”‚                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Planner  â”‚â”€â–¶â”‚Executor â”‚â”€â–¶â”‚Analysis + LLM â­ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚            â”‚                â”‚            â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                    â–¼                             â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚             â”‚World Model  â”‚                      â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                    â”‚
            RESTful API          OpenAI Compatible API
                    â”‚                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ SCI Service       â”‚   â”‚ LLM Service  â”‚
        â”‚ - CIAS-Core       â”‚   â”‚ - GPT-4      â”‚
        â”‚ - Training        â”‚   â”‚ - DeepSeek   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ - Qwen       â”‚
                                 â”‚ - Ollama     â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒæ¨¡å—

### 1. World Model

**æ•°æ®åº“è¡¨ï¼ˆæ–°å¢ LLM ç›¸å…³ï¼‰**:

```sql
-- LLM åˆ†æè®°å½•è¡¨
CREATE TABLE llm_analyses (
    id INTEGER PRIMARY KEY,
    cycle_number INTEGER,
    analysis_type TEXT,  -- pareto_verification, trend_analysis, recommendation
    input_summary TEXT,
    llm_response TEXT,
    conclusions_json TEXT,
    model_name TEXT,
    tokens_used INTEGER,
    timestamp TIMESTAMP
);

-- å¸•ç´¯æ‰˜å‰æ²¿è¡¨ï¼ˆå¢åŠ  LLM éªŒè¯ï¼‰
CREATE TABLE pareto_front (
    id INTEGER PRIMARY KEY,
    experiment_id TEXT,
    cycle_number INTEGER,
    objectives_json TEXT,
    llm_verification TEXT,  -- LLMéªŒè¯ç»“æœ
    timestamp TIMESTAMP
);
```

**æ–°å¢æ–¹æ³•**:
- `save_llm_analysis()`: ä¿å­˜ LLM åˆ†æè®°å½•
- `get_historical_analyses()`: è·å–å†å²åˆ†æ

---

### 2. Analysis Agent + LLM â­

**æ ¸å¿ƒåŠŸèƒ½**:
1. è®¡ç®—å¸•ç´¯æ‰˜å‰æ²¿
2. LLM éªŒè¯å‰æ²¿åˆç†æ€§
3. LLM æ·±åº¦è¶‹åŠ¿åˆ†æ
4. LLM ç”Ÿæˆå®éªŒå»ºè®®

**LLM å®¢æˆ·ç«¯**:

```python
from openai import OpenAI

class LLMClient:
    def __init__(self, config):
        self.client = OpenAI(
            api_key=config['api_key'],
            base_url=config.get('base_url', 'https://api.openai.com/v1')
        )
        self.model = config.get('model', 'gpt-4-turbo-preview')

    def chat(self, messages, response_format="text"):
        response = self.client.chat.completions.create(
            model=self.model,
            messages=messages,
            temperature=0.3,
            max_tokens=4096
        )
        return {
            'content': response.choices[0].message.content,
            'tokens': response.usage.total_tokens
        }
```

**åˆ†ææµç¨‹**:

```python
class AnalysisAgent:
    def analyze(self, world_model, cycle):
        # 1. è®¡ç®—å¸•ç´¯æ‰˜å‰æ²¿
        pareto_ids = self._compute_pareto_front(experiments)

        # 2. LLM éªŒè¯
        verification = self._llm_verify_pareto(experiments, pareto_ids)

        # 3. LLM è¶‹åŠ¿åˆ†æ
        trends = self._llm_analyze_trends(experiments, pareto_ids)

        # 4. LLM ç”Ÿæˆå»ºè®®
        recommendations = self._llm_generate_recommendations(trends)

        return pareto_ids, {
            'verification': verification,
            'trends': trends,
            'recommendations': recommendations
        }
```

---

### 3. LLM æç¤ºè¯è®¾è®¡

#### å¸•ç´¯æ‰˜éªŒè¯æç¤ºè¯

```
ä½ æ˜¯ SCI é¢†åŸŸä¸“å®¶ã€‚è¯·éªŒè¯ä»¥ä¸‹å¸•ç´¯æ‰˜å‰æ²¿æ˜¯å¦åˆç†ã€‚

å®éªŒæ•°æ®:
[å®éªŒåˆ—è¡¨ï¼ŒåŒ…å«é…ç½®å’Œæ€§èƒ½æŒ‡æ ‡]

è¯·åˆ†æ:
1. æ˜¯å¦è¦†ç›–å…³é”®æ€§èƒ½åŒºé—´
2. æ˜¯å¦å­˜åœ¨å¼‚å¸¸ç‚¹
3. Trade-off æ˜¯å¦åˆç†
4. æ”¹è¿›å»ºè®®

è¿”å› JSON æ ¼å¼:
{
  "is_reasonable": bool,
  "anomalies": [...],
  "suggestions": [...]
}
```

#### è¶‹åŠ¿åˆ†ææç¤ºè¯

```
ä½ æ˜¯æ•°æ®åˆ†æä¸“å®¶ã€‚è¯·ä»å®éªŒæ•°æ®ä¸­æå–æ·±å±‚æ´å¯Ÿã€‚

æ•°æ®ç»Ÿè®¡:
[å‚æ•°ç»Ÿè®¡ã€æ€§èƒ½ç»Ÿè®¡ã€ç›¸å…³æ€§]

è¯·åˆ†æ:
1. å“ªäº›å‚æ•°å½±å“æœ€å¤§
2. æœ€ä½³é…ç½®æ¨¡å¼
3. æ€§èƒ½ç“¶é¢ˆ
4. æ„å¤–å‘ç°

è¿”å› JSON æ ¼å¼:
{
  "key_findings": [...],
  "best_patterns": {...},
  "bottlenecks": [...]
}
```

#### å®éªŒå»ºè®®æç¤ºè¯

```
åŸºäºå½“å‰è¿›å±•ï¼Œè¯·æä¾›å®éªŒå»ºè®®ã€‚

å½“å‰çŠ¶æ€:
[å·²å®Œæˆå®éªŒæ•°ã€æœ€ä½³æ€§èƒ½ã€è¶‹åŠ¿æ´å¯Ÿ]

è¯·æä¾›:
1. ä¼˜å…ˆæ¢ç´¢æ–¹å‘
2. 3-5ä¸ªå…·ä½“é…ç½®å»ºè®®
3. æ¢ç´¢ç­–ç•¥
4. é¢„æœŸæ”¶ç›Š

è¿”å› JSON æ ¼å¼:
{
  "priority_directions": [...],
  "config_suggestions": [...],
  "strategy": "...",
  "expected_improvements": {...}
}
```

---

## æ”¯æŒçš„ LLM æœåŠ¡

| æœåŠ¡ | Base URL | æ¨¡å‹ |
|------|----------|------|
| OpenAI | https://api.openai.com/v1 | gpt-4-turbo-preview |
| DeepSeek | https://api.deepseek.com/v1 | deepseek-chat |
| Qwen | https://dashscope.aliyuncs.com/compatible-mode/v1 | qwen-turbo |
| Moonshot | https://api.moonshot.cn/v1 | moonshot-v1-8k |
| Ollama (æœ¬åœ°) | http://localhost:11434/v1 | llama2, mistral |

---

## é…ç½®æ–‡ä»¶

```yaml
analysis:
  llm:
    # OpenAI é…ç½®
    base_url: "https://api.openai.com/v1"
    api_key: "${OPENAI_API_KEY}"
    model: "gpt-4-turbo-preview"
    temperature: 0.3
    max_tokens: 4096

    # æˆ–ä½¿ç”¨ DeepSeek
    # base_url: "https://api.deepseek.com/v1"
    # api_key: "${DEEPSEEK_API_KEY}"
    # model: "deepseek-chat"

    # æˆ–ä½¿ç”¨æœ¬åœ° Ollama
    # base_url: "http://localhost:11434/v1"
    # api_key: "ollama"
    # model: "llama2"

design_space:
  compression_ratios: [8, 16, 24]
  mask_types: ["random", "optimized"]
  recon_families: ["CIAS-Core"]
  num_stages: [5, 7, 9]
  num_features: [32, 64, 128]
  learning_rates: [1e-4, 5e-5]
```

---

## ä½¿ç”¨æŒ‡å—

### å®‰è£…ä¾èµ–

```bash
pip install numpy loguru requests tenacity openai scipy pyyaml
```

### è¿è¡Œ

```bash
# 1. è®¾ç½® API Key
export OPENAI_API_KEY="sk-..."

# 2. Mock æ¨¡å¼è¿è¡Œï¼ˆæµ‹è¯•ç”¨ï¼‰
python main_v3.py --mock --config config.yaml

# 3. æŸ¥çœ‹ LLM åˆ†æç»“æœ
sqlite3 world_model.db "SELECT * FROM llm_analyses ORDER BY timestamp DESC LIMIT 5"
```

### è¾“å‡ºç¤ºä¾‹

```json
{
  "pareto_front": {
    "experiment_ids": ["exp_001", "exp_045", "exp_087"],
    "count": 3,
    "verification": {
      "is_reasonable": true,
      "anomalies": [],
      "tradeoff_quality": "åˆç†çš„PSNR-å»¶è¿Ÿæƒè¡¡"
    }
  },
  "trends": {
    "key_findings": [
      "å¢åŠ unrolling stagesæ˜¾è‘—æå‡PSNR",
      "ç‰¹å¾é€šé“æ•°ä¸SSIMå¼ºç›¸å…³",
      "å‹ç¼©æ¯”16æ—¶æ€§ä»·æ¯”æœ€é«˜"
    ],
    "best_patterns": {
      "compression_ratio": 16,
      "num_stages": 7,
      "num_features": 64
    }
  },
  "recommendations": {
    "config_suggestions": [
      {"cr": 16, "stages": 9, "features": 64},
      {"cr": 24, "stages": 7, "features": 128}
    ],
    "strategy": "åœ¨CR=16é™„è¿‘åšç²¾ç»†æ¢ç´¢"
  }
}
```

---

## æ‰©å±•å¼€å‘

### ä½¿ç”¨å…¶ä»– LLM

```python
# åªéœ€ä¿®æ”¹é…ç½®
llm_config = {
    'base_url': 'http://your-llm-service/v1',
    'api_key': 'your-key',
    'model': 'your-model'
}

analyzer = AnalysisAgent(llm_config)
```

### è‡ªå®šä¹‰åˆ†æé€»è¾‘

```python
class CustomAnalysisAgent(AnalysisAgent):
    def _llm_custom_analysis(self, experiments):
        prompt = "è‡ªå®šä¹‰æç¤ºè¯..."
        response = self.llm_client.chat([
            {"role": "user", "content": prompt}
        ])
        return json.loads(response['content'])
```

---

## æ€»ç»“

### v3.0 æ ¸å¿ƒç‰¹æ€§

âœ… LLM é©±åŠ¨çš„å¸•ç´¯æ‰˜éªŒè¯  
âœ… æ™ºèƒ½è¶‹åŠ¿åˆ†æå’Œæ¨¡å¼å‘ç°  
âœ… è‡ªåŠ¨ç”Ÿæˆå®éªŒå»ºè®®  
âœ… æ”¯æŒæ‰€æœ‰ OpenAI å…¼å®¹ LLM  
âœ… å®Œæ•´çš„åˆ†æè¿‡ç¨‹è¿½æº¯  
âœ… ç”Ÿäº§å°±ç»ªçš„é”™è¯¯å¤„ç†  

### ä¸‹ä¸€æ­¥

- ğŸ”„ Planner å‡çº§ä¸º LLM é©±åŠ¨
- ğŸ“Š å®æ—¶å¯è§†åŒ– Dashboard
- ğŸŒ Web UI ç•Œé¢

---

**ç‰ˆæœ¬**: 3.0.0  
**æ—¥æœŸ**: 2025-12-20  
**æ ¸å¿ƒå‡çº§**: AnalysisAgent ä½¿ç”¨ LLM æ™ºèƒ½åˆ†æ  
**ä½œè€…**: AI Scientist Team
